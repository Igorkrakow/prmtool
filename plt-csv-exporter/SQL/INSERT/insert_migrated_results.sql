INSERT INTO TXSTORE.MIGRATED_RESULTS( ID, LOTTERY_TX_HEADER_ID,DRAWNUMBER,PRODUCT,TRANSACTION_AMOUNT,TRANSACTION_TIME_UTC,TX_DRAW_ENTRY_ID,UUID,WINNINGDIVISION)
SELECT TXSTORE.MIGRATED_RESULTS_SEQ.NEXTVAL,LTV.LOTTERY_TX_HEADER_ID,DE.DRAWNUMBER,LTV.PRODUCT,LTV.TRANSACTION_AMOUNT,LTV.TRANSACTION_TIME_UTC,DE.ID,VTH.UUID,mtt.WINNINGDIVISION
FROM
    TXSTORE.MIGR_TX_HEADER VTH
        JOIN  TXSTORE.LOTTERY_TX_HEADER LTV
              ON LTV.LOTTERY_TX_HEADER_ID = VTH.TX_HEADER_ID
                  and ltv.LOTTERY_TRANSACTION_TYPE = 'VALIDATION'
        JOIN TXSTORE.LOTTERY_TX_HEADER LTW
             ON LTV.GLOBAL_TRANS_ID = LTW.GLOBAL_TRANS_ID
                 AND LTV.SERIAL = LTW.SERIAL
                 AND LTW.LOTTERY_TRANSACTION_TYPE = 'WAGER'
        JOIN TXSTORE.TX_HEADER TH
             ON LTW.LOTTERY_TX_HEADER_ID = TH.TX_HEADER_ID
        JOIN TXSTORE.MIGRATED_TX_DRAW_ENTRY DE
             ON TH.UUID = DE.UUID
                 AND DE.DRAWNUMBER = LTV.START_DRAW_NUMBER
        JOIN TXSTORE.MIGRATED_TX_TRANSACTION mtt on mtt.TX_TRANSACTION_ID=VTH.TX_HEADER_ID
    @
INSERT INTO TXSTORE.MIGRATED_RESULTS( ID, LOTTERY_TX_HEADER_ID,DRAWNUMBER,PRODUCT,TRANSACTION_AMOUNT,TRANSACTION_TIME_UTC,TX_DRAW_ENTRY_ID,UUID,WINNINGDIVISION)
SELECT TXSTORE.MIGRATED_RESULTS_SEQ.NEXTVAL,LTV.LOTTERY_TX_HEADER_ID,DE.DRAWNUMBER,LTV.PRODUCT,LTV.TRANSACTION_AMOUNT,LTV.TRANSACTION_TIME_UTC,DE.ID,VTH.UUID,mtt.WINNINGDIVISION
FROM
    TXSTORE.MIGR_TX_HEADER VTH
        JOIN  TXSTORE.LOTTERY_TX_HEADER LTV
              ON LTV.LOTTERY_TX_HEADER_ID = VTH.TX_HEADER_ID
                  AND VTH.TX_HEADER_ID not in (SELECT LOTTERY_TX_HEADER_ID
                                               FROM TXSTORE.MIGRATED_RESULTS)
                  and ltv.LOTTERY_TRANSACTION_TYPE = 'VALIDATION'
        JOIN TXSTORE.LOTTERY_TX_HEADER LTW
             ON LTV.CDC = LTW.CDC
                 AND LTV.SERIAL = LTW.SERIAL
                 AND LTW.LOTTERY_TRANSACTION_TYPE = 'WAGER'
        JOIN TXSTORE.TX_HEADER TH
             ON LTW.LOTTERY_TX_HEADER_ID = TH.TX_HEADER_ID
        JOIN TXSTORE.MIGRATED_TX_DRAW_ENTRY DE
             ON TH.UUID = DE.UUID
                 AND DE.DRAWNUMBER = LTV.START_DRAW_NUMBER
        JOIN TXSTORE.MIGRATED_TX_TRANSACTION mtt on mtt.TX_TRANSACTION_ID=VTH.TX_HEADER_ID
@




