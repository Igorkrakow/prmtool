--Should be
SELECT
    count(*)
FROM TXSTORE.LOTTERY_TX_HEADER LTHW
         JOIN TXSTORE.TX_HEADER THW ON THW.TX_HEADER_ID = LTHW.LOTTERY_TX_HEADER_ID
    AND LTHW.LOTTERY_TRANSACTION_TYPE = 'WAGER'
    AND TRANSACTION_TIME_LOCAL >= '2022-11-25 00:00:00.000000' AND TRANSACTION_TIME_LOCAL < '2022-12-25 00:00:00.000000';

--Should be closed
SELECT
    count(*)
FROM TXSTORE.LOTTERY_TX_HEADER LTHW
         JOIN TXSTORE.TX_HEADER THW ON THW.TX_HEADER_ID = LTHW.LOTTERY_TX_HEADER_ID
    AND LTHW.LOTTERY_TRANSACTION_TYPE = 'WAGER'
    AND TRANSACTION_TIME_LOCAL >= '2022-11-25 00:00:00.000000' AND TRANSACTION_TIME_LOCAL < '2022-12-25 00:00:00.000000'
         JOIN TXSTORE.LAST_CLOSED ON LTHW.PRODUCT = TXSTORE.LAST_CLOSED.IDDGGAME
    AND END_DRAW_NUMBER <= TXSTORE.LAST_CLOSED.DRAWNUMBER;

--Should be opened
SELECT
    count(*)
FROM TXSTORE.LOTTERY_TX_HEADER LTHW
         JOIN TXSTORE.TX_HEADER THW ON THW.TX_HEADER_ID = LTHW.LOTTERY_TX_HEADER_ID
    AND LTHW.LOTTERY_TRANSACTION_TYPE = 'WAGER'
    AND TRANSACTION_TIME_LOCAL >= '2022-11-25 00:00:00.000000' AND TRANSACTION_TIME_LOCAL < '2022-12-25 00:00:00.000000'
         JOIN TXSTORE.LAST_CLOSED ON LTHW.PRODUCT = TXSTORE.LAST_CLOSED.IDDGGAME
    AND END_DRAW_NUMBER > TXSTORE.LAST_CLOSED.DRAWNUMBER;


--WE HAVE PURCHASE
select count(*) from TXSTORE.TMP_TSO_PURCHASE
WHERE START_DATE_RUN = '2022-11-25 00:00:00.000000' AND
      END_DATE_RUN = '2022-12-25 00:00:00.000000';

--opened from them
select count(*) from TXSTORE.TMP_TSO_OPEN_TRANSACTION;
--WHERE START_DATE_RUN = '2022-11-25 00:00:00.000000' AND
        --END_DATE_RUN = '2022-12-25 00:00:00.000000';





